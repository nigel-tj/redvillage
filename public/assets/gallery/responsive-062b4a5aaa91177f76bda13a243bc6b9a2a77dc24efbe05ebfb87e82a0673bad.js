$(function(){$.fn.imagesLoaded=function(e){function i(){e.call(a,t)}function r(){--n<=0&&this.src!==l&&(setTimeout(i),t.off("load error",r))}var t=this.find("img"),n=t.length,a=this,l="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";return n||i(),t.on("load error",r).each(function(){if(this.complete||void 0===this.complete){var e=this.src;this.src=l,this.src=e}}),this};var e=$("#rg-gallery"),i=e.find("div.es-carousel-wrapper"),r=i.find("ul > li"),t=r.length;Gallery=function(){var n=0,a="carousel",l=!1,s=function(){r.add('<img src="/assets/gallery/responsive/icons/ajax-loader.gif"/><img src="/assets/gallery/responsive/icons/black.png"/>').imagesLoaded(function(){c(),o(),f(r.eq(n))}),"carousel"===a&&d()},d=function(){i.show().elastislide({imageW:65,onClick:function(e){return l?!1:(l=!0,f(e),void(n=e.index()))}}),i.elastislide("setCurrent",n)},c=function(){var r=$('<a href="#" class="rg-view-full"></a>'),t=$('<a href="#" class="rg-view-thumbs rg-view-selected"></a>');e.prepend($('<div class="rg-view"/>').append(r).append(t)),r.on("click.rgGallery",function(){return"carousel"===a&&i.elastislide("destroy"),i.hide(),r.addClass("rg-view-selected"),t.removeClass("rg-view-selected"),a="fullview",!1}),t.on("click.rgGallery",function(){return d(),t.addClass("rg-view-selected"),r.removeClass("rg-view-selected"),a="carousel",!1}),"fullview"===a&&r.trigger("click")},o=function(){try{$("#img-wrapper-tmpl").tmpl({itemsCount:t}).prependTo(e)}catch(i){return}if(t>1){var r=e.find("a.rg-image-nav-prev"),n=e.find("a.rg-image-nav-next"),a=e.find("div.rg-image");r.on("click.rgGallery",function(){return g("left"),!1}),n.on("click.rgGallery",function(){return g("right"),!1}),a.touchwipe({wipeLeft:function(){g("right")},wipeRight:function(){g("left")},preventDefaultEvents:!1}),$(document).on("keyup.rgGallery",function(e){39==e.keyCode?g("right"):37==e.keyCode&&g("left")})}},g=function(e){return l?!1:(l=!0,"right"===e?n+1>=t?n=0:++n:"left"===e&&(0>n-1?n=t-1:--n),void f(r.eq(n)))},f=function(t){var s=e.find("div.rg-loading").show();r.removeClass("selected"),t.addClass("selected");var d=t.find("img"),c=d.data("large"),o=d.data("description");$("<img/>").load(function(){e.find("div.rg-image").empty().append('<img src="'+c+'"/>'),o&&e.find("div.rg-caption").show().children("p").empty().text(o),s.hide(),"carousel"===a&&(i.elastislide("reload"),i.elastislide("setCurrent",n)),l=!1}).attr("src",c)},u=function(e){i.find("ul").append(e),r=r.add($(e)),t=r.length,i.elastislide("add",e)};return{init:s,addItems:u}}(),Gallery.init()});