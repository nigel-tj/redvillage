<%= storefront_css(@store) %>
<div class="container mt-4">
  <div class="row">
    <div class="col-lg-8">
      <div class="card shadow-sm">
        <% if @store.cover.present? %>
          <div style="height: 400px; overflow: hidden;">
            <%= image_tag @store.cover, alt: @store.name, style: "width: 100%; height: 100%; object-fit: cover;" %>
          </div>
        <% else %>
          <div class="bg-secondary d-flex align-items-center justify-content-center" style="height: 400px;">
            <i class="fas fa-store fa-5x text-white"></i>
          </div>
        <% end %>
        
        <div class="card-body">
          <h1 class="card-title"><%= @store.name %></h1>
          
          <% unless @store.active? %>
            <div class="alert alert-warning">
              <i class="fas fa-exclamation-triangle me-1"></i>
              This store is currently inactive.
            </div>
          <% end %>
          
          <div class="mb-3">
            <h5>About</h5>
            <p class="text-muted"><%= simple_format(@store.description) %></p>
          </div>
          
          <hr>
          
          <div class="row">
            <div class="col-md-6 mb-3">
              <h6><i class="fas fa-envelope me-2"></i>Email</h6>
              <p class="text-muted"><%= @store.email %></p>
            </div>
            <% if @store.contact_number.present? %>
              <div class="col-md-6 mb-3">
                <h6><i class="fas fa-phone me-2"></i>Contact</h6>
                <p class="text-muted"><%= @store.contact_number %></p>
              </div>
            <% end %>
            <div class="col-md-6 mb-3">
              <h6><i class="fas fa-user me-2"></i>Owner</h6>
              <p class="text-muted"><%= @store.user.name %></p>
            </div>
            <% if @store.mall.present? %>
              <div class="col-md-6 mb-3">
                <h6><i class="fas fa-building me-2"></i>Mall</h6>
                <p class="text-muted">
                  <%= link_to @store.mall.name, mall_path(@store.mall), class: "text-decoration-none" %>
                </p>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>
    
    <div class="col-lg-4">
      <div class="card shadow-sm mb-3">
        <div class="card-body">
          <% if user_signed_in? && (@store.owner?(current_user) || current_user.admin?) %>
            <h5 class="card-title">Manage Store</h5>
            <div class="d-grid gap-2">
              <% if @store.owner?(current_user) %>
                <%= link_to store_dashboard_path(@store), class: "btn btn-primary" do %>
                  <i class="fas fa-tachometer-alt me-1"></i> Dashboard
                <% end %>
              <% end %>
              <%= link_to store_products_path(@store), class: "btn btn-outline-primary" do %>
                <i class="fas fa-shopping-bag me-1"></i> View Products
              <% end %>
              <%= link_to edit_store_path(@store), class: "btn btn-outline-secondary" do %>
                <i class="fas fa-edit me-1"></i> Edit Store
              <% end %>
              <%= link_to edit_store_storefront_settings_path(@store), class: "btn btn-outline-secondary" do %>
                <i class="fas fa-paint-brush me-1"></i> Customize Storefront
              <% end %>
              <% if current_user.admin? %>
                <% if @store.active? %>
                  <%= link_to deactivate_store_path(@store), method: :patch, class: "btn btn-warning", 
                      confirm: "Are you sure you want to deactivate this store?" do %>
                    <i class="fas fa-ban me-1"></i> Deactivate
                  <% end %>
                <% else %>
                  <%= link_to activate_store_path(@store), method: :patch, class: "btn btn-success" do %>
                    <i class="fas fa-check me-1"></i> Activate
                  <% end %>
                <% end %>
              <% end %>
              <% if @store.owner?(current_user) || current_user.admin? %>
                <%= link_to store_path(@store), method: :delete, class: "btn btn-danger",
                    confirm: "Are you sure you want to delete this store? This action cannot be undone." do %>
                  <i class="fas fa-trash me-1"></i> Delete Store
                <% end %>
              <% end %>
            </div>
          <% else %>
            <h5 class="card-title">Contact Store</h5>
            <p class="text-muted">Email: <%= @store.email %></p>
            <% if @store.contact_number.present? %>
              <p class="text-muted">Phone: <%= @store.contact_number %></p>
            <% end %>
          <% end %>
        </div>
      </div>
      
      <div class="card shadow-sm">
        <div class="card-body">
          <h5 class="card-title">Store Info</h5>
          <ul class="list-unstyled mb-0">
            <li class="mb-2">
              <small class="text-muted">Created</small><br>
              <%= time_ago_in_words(@store.created_at) %> ago
            </li>
            <li class="mb-2">
              <small class="text-muted">Status</small><br>
              <% if @store.active? %>
                <span class="badge bg-success">Active</span>
              <% else %>
                <span class="badge bg-warning text-dark">Inactive</span>
              <% end %>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>
