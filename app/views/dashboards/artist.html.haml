.container-fluid.mt-4
  .row.mb-4
    .col-md-12
      %h1.mb-4 Artist Dashboard
      %p Welcome back, #{@user.name}!
      %p.text-muted Manage your music, tracks, and albums.
      = render 'shared/profile_quick_links', user: @user

  .row.mb-4
    .col-md-3
      .card.text-center
        .card-body
          %h5.card-title Total Tracks
          %h2= @stats[:total_tracks]
    .col-md-3
      .card.text-center
        .card-body
          %h5.card-title My Tracks
          %h2= @stats[:my_tracks]
    .col-md-3
      .card.text-center
        .card-body
          %h5.card-title Total Albums
          %h2= @stats[:total_albums]
    .col-md-3
      .card.text-center
        .card-body
          %h5.card-title My Albums
          %h2= @stats[:my_albums]

  .row.mb-4
    .col-md-12
      .card
        .card-header.d-flex.justify-content-between.align-items-center
          %h5.mb-0 My Tracks
          = link_to "Upload New Track", new_track_path, class: "btn btn-primary btn-sm"
        .card-body
          - if @user_tracks.any?
            .table-responsive
              %table.table.table-hover
                %thead
                  %tr
                    %th Track Title
                    %th Album
                    %th Category
                    %th Created
                    %th Actions
                %tbody
                  - @user_tracks.each do |track|
                    %tr
                      %td= track.title
                      %td= track.album&.name || "N/A"
                      %td
                        - if track.category.present?
                          %span.badge.bg-secondary= track.category
                      %td= time_ago_in_words(track.created_at) + " ago"
                      %td
                        = link_to "View", track_path(track), class: "btn btn-sm btn-primary me-1"
                        = link_to "Edit", edit_track_path(track), class: "btn btn-sm btn-outline-secondary"
          - else
            %p.text-muted No tracks uploaded yet.
            = link_to "Upload Your First Track", new_track_path, class: "btn btn-primary"

  .row.mb-4
    .col-md-12
      .card
        .card-header.d-flex.justify-content-between.align-items-center
          %h5.mb-0 My Albums
          = link_to "Create New Album", new_album_path, class: "btn btn-primary btn-sm"
        .card-body
          - if @user_albums.any?
            .table-responsive
              %table.table.table-hover
                %thead
                  %tr
                    %th Album Name
                    %th Artist
                    %th Tracks Count
                    %th Created
                    %th Actions
                %tbody
                  - @user_albums.each do |album|
                    %tr
                      %td= album.name
                      %td= album.artist_name || "N/A"
                      %td= Track.where(album_id: album.id).count
                      %td= time_ago_in_words(album.created_at) + " ago"
                      %td
                        = link_to "View", album_path(album), class: "btn btn-sm btn-primary me-1"
                        = link_to "Edit", edit_album_path(album), class: "btn btn-sm btn-outline-secondary"
          - else
            %p.text-muted No albums created yet.
            = link_to "Create Your First Album", new_album_path, class: "btn btn-primary"

  .row.mb-4
    .col-md-12
      .card
        .card-header
          %h5.mb-0 Quick Actions
        .card-body
          .row
            .col-md-3
              = link_to "Upload Track", new_track_path, class: "btn btn-primary w-100 mb-2"
            .col-md-3
              = link_to "Create Album", new_album_path, class: "btn btn-outline-primary w-100 mb-2"
            .col-md-3
              = link_to "View All Tracks", tracks_path, class: "btn btn-outline-secondary w-100 mb-2"
            .col-md-3
              = link_to "View All Albums", albums_path, class: "btn btn-outline-secondary w-100 mb-2"

  .row
    .col-md-6
      .card
        .card-header
          %h5.mb-0 Recent Tracks
        .card-body
          - if @tracks.any?
            %ul.list-group.list-group-flush
              - @tracks.first(5).each do |track|
                %li.list-group-item
                  = link_to track.title, track_path(track), class: "fw-bold"
                  %small.text-muted.d-block
                    = track.artist_name || "Unknown Artist"
                    = " - " + time_ago_in_words(track.created_at) + " ago"
          - else
            %p.text-muted No tracks available.

    .col-md-6
      .card
        .card-header
          %h5.mb-0 Recent Albums
        .card-body
          - if @albums.any?
            %ul.list-group.list-group-flush
              - @albums.first(5).each do |album|
                %li.list-group-item
                  = link_to album.name, album_path(album), class: "fw-bold"
                  %small.text-muted.d-block
                    = album.artist_name || "Unknown Artist"
                    = " - " + time_ago_in_words(album.created_at) + " ago"
          - else
            %p.text-muted No albums available.

